import{T as g}from"./TopBar-CpGf_tp8.js";import{_ as P,r as n,g as y,c as b,a as v,b as s,w as x,k as d,v as i,n as C,t as D,m as _,F as B,q as l,d as w,e as T,x as R}from"./index-DNkYr-Dp.js";import{u as f}from"./user-1tW7kAz0.js";import"./userInfo-C0I0oh51.js";import"./logo-Ox0-xbTo.js";const V={components:{TopBar:g},setup(){const a=n({email:"",code:"",password:"",rePassword:""}),e=n(!1),r=n(60),o=n(null),m=y(()=>e.value?`${r.value}s 后重试`:"发送"),c=t=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t);return{resetPwdData:a,sendCode:async()=>{if(!e.value){if(!c(a.value.email)){l.message("请输入有效的邮箱地址","danger");return}e.value=!0;try{const t=await f.sendCode(a.value.email,3);console.log(t),l.message("验证码已发送","success"),o.value=setInterval(()=>{r.value>0?r.value--:(clearInterval(o.value),e.value=!1,r.value=60)},1e3)}catch{l.message("发送验证码失败，请稍后再试","danger"),e.value=!1}}},isSending:e,sendButtonText:m,handleResetPwd:async()=>{if(!c(a.value.email)){l.message("请输入有效的邮箱地址","danger");return}if(a.value.password!==a.value.rePassword){l.message("两次密码输入不一致","danger");return}(await f.resetPwd(a.value)).code===0&&l.message("重置密码成功！")}}}},k={class:"login-container"},q={class:"card login-container-card noto-serif-sc-text"},U={class:"card-body"},E={class:"col-md-12"},S={class:"input-group",style:{margin:"0px"}},I={class:"col-md-12"},N={class:"col-md-12"},z={class:"row"},F={class:"col text-start"};function M(a,e,r,o,m,c){const u=w("TopBar"),p=w("router-link");return T(),b(B,null,[v(u,{style:{opacity:"0.8",color:"aliceblue"}}),s("div",k,[s("div",q,[s("div",U,[e[12]||(e[12]=s("div",{class:"row login-container-card-type"},[s("div",{style:{"text-align":"center","font-size":"20px","font-weight":"900",color:"#de7622"}}," 重置密码 ")],-1)),s("form",{onSubmit:e[5]||(e[5]=x((...t)=>o.handleResetPwd&&o.handleResetPwd(...t),["prevent"])),class:"row g-3"},[s("div",E,[e[6]||(e[6]=s("label",{for:"validationEmail",class:"form-label"},"邮箱",-1)),d(s("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>o.resetPwdData.email=t),type:"email",class:"form-control",placeholder:"请输入邮箱",id:"validationEmail",required:""},null,512),[[i,o.resetPwdData.email]])]),e[9]||(e[9]=s("label",{for:"validationCode",class:"form-label"},"验证码",-1)),s("div",S,[d(s("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>o.resetPwdData.code=t),type:"text",class:"form-control",placeholder:"请输入验证码",id:"validationCode",required:""},null,512),[[i,o.resetPwdData.code]]),s("span",{class:C(["input-group-text",{disabled:o.isSending}]),onClick:e[2]||(e[2]=(...t)=>o.sendCode&&o.sendCode(...t)),style:{cursor:"pointer"}},D(o.sendButtonText),3)]),s("div",I,[e[7]||(e[7]=s("label",{for:"validationPwd",class:"form-label"},"密码",-1)),d(s("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>o.resetPwdData.password=t),type:"password",class:"form-control",placeholder:"请输入密码",id:"validationPwd",required:""},null,512),[[i,o.resetPwdData.password]])]),s("div",N,[e[8]||(e[8]=s("label",{for:"validationRePwd",class:"form-label"},"确认密码",-1)),d(s("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>o.resetPwdData.rePassword=t),type:"password",class:"form-control",placeholder:"请再次输入密码",id:"validationRePwd",required:""},null,512),[[i,o.resetPwdData.rePassword]])]),e[10]||(e[10]=s("div",{class:"col-12"},[s("button",{class:"btn btn-primary col-12",type:"submit"},"提交")],-1))],32),s("div",z,[s("span",F,[v(p,{to:"/login",style:{"text-decoration":"none"}},{default:_(()=>e[11]||(e[11]=[R(" 去登录！ ")])),_:1})])])])])])],64)}const L=P(V,[["render",M],["__scopeId","data-v-3846f43d"]]);export{L as default};
