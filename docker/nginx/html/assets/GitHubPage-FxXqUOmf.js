import{_ as l,u as d,o as p,c as f,b as k,p as m,y as h,e as g}from"./index-DNkYr-Dp.js";import{u}from"./user-1tW7kAz0.js";import{u as _}from"./userInfo-C0I0oh51.js";const y={name:"OAuthCallback",setup(){const e=m(),r=h(),n=d(),a=async()=>(await u.getCurrentUser()).data;return p(async()=>{const t=new URLSearchParams(r.query).get("code");if(t)try{const s=await u.loginGitHub(t),o={token:"",refreshToken:""};if(o.token=s.data.token,o.refreshToken=s.data.refreshToken,console.log(o),o.token!=""){n.setToken(o);const i=await a();_().setInfo(i),e.push("/")}else console.error("No token received"),e.push({name:"login",query:{error:"认证失败，请重试。"}})}catch(s){console.error("Error during OAuth callback processing:",s),e.push({name:"login",query:{error:"认证过程中发生错误，请重试。"}})}else console.error("No code found in URL"),e.push({name:"login",query:{error:"缺少授权码，请重试。"}})}),{}}},b={class:"container"};function w(e,r,n,a,c,t){return g(),f("div",b,r[0]||(r[0]=[k("h1",null,"正在处理您的请求，请稍候。",-1)]))}const q=l(y,[["render",w],["__scopeId","data-v-b7deed71"]]);export{q as default};
