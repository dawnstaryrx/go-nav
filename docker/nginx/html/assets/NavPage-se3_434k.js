import{H as O}from"./HelloWorld-DqKlw70W.js";import{T as E}from"./TopBar-CpGf_tp8.js";import{R as N}from"./RecursiveCategory-CB-QdkF3.js";import{c as P}from"./category-D9zZmuIX.js";import{a as y}from"./app-BmTou4JB.js";import{_ as S,r as d,o as L,f as D,g as z,d as A,e as c,c as i,b as n,n as w,F as h,h as x,t as g,a as k,j as K}from"./index-DNkYr-Dp.js";import"./userInfo-C0I0oh51.js";import"./logo-Ox0-xbTo.js";const R={name:"SearchCenter",components:{RecursiveCategory:N},props:{username:{type:String,required:!0}},setup(_){const a=d(null),u=d([]),e=d({username:_.username,categoryId:null}),m=d("ALL");L(()=>{window.addEventListener("keydown",p)}),D(()=>{window.removeEventListener("keydown",p)});const f=async o=>{o.preventDefault();const r=a.value.value.trim();if(r&&r!==""){const C=await y.searchAppByUsername(e.value.username,r);u.value=C.data,console.log("query",r),console.log(C.data),console.log("搜索查询:",r)}else r===""?b():console.log("请输入搜索内容")},p=o=>{if(o.ctrlKey||o.altKey||o.metaKey||o.shiftKey)return;const r=document.activeElement;r.tagName==="INPUT"||r.tagName==="TEXTAREA"||r.isContentEditable||o.key.length===1&&(o.preventDefault(),a.value.focus(),a.value.value=o.key)},t=d([]),s=d(null),l=d(null),B=z(()=>t.value.filter(o=>o.parentId===null)),I=o=>{l.value=o,console.log("选中的分类ID:",l.value.id),o.children.length>0?s.value=o:s.value=s.value,l.value&&s.value&&l.value.id!=s.value.id&&l.value.parentId!==s.value.id&&(s.value=null),e.value.categoryId=l?l.value.id:null,console.log("选中的分类id:",l.value.id,"更新app appListDTO.value.categoryId",e.value.categoryId),v()},H=async()=>{try{const o=await P.getCategoryByUsername(e.value.username,e.value.categoryId);console.log("从后端获取分类数据",o),t.value=o.data}catch(o){console.error(o)}};L(()=>{H()});const v=async()=>{try{const o=await y.getAppByUsernameAndCategoryIdPublic(e.value.username,e.value.categoryId);console.log("获取APP",o),u.value=o.data}catch(o){console.error(o)}},U=async o=>{await y.clickApp(o)},b=()=>{e.value.categoryId=null,I.value=null,v()},T=async()=>{const o=await y.getHotAppByUsername(e.value.username);console.log("获取热门APP",o),l.id="hot",u.value=o.data};return v(),{searchInput:a,handleSearch:f,topLevelCategories:B,selectedCategory:s,selectCategory:I,nowCategory:l,appList:u,getAppList:v,getAllApp:b,nowHotOrAll:m,clickApp:U,getHotApp:T}}},F={class:"content-section-search-container"},q={ref:"searchInput",class:"form-control me-2",type:"search",placeholder:"按任意键开始搜索~~","aria-label":"Search",style:{border:"0px","box-shadow":"0 0 0 0rem"}},M={class:"content-section-category-container"},V=["onClick","title"],j={key:0,class:"content-section-category-container",style:{"margin-top":"10px"}},W={class:"row apps-container"},X=["title"],G=["href","onClick"],J={class:"app-card d-flex align-items-center"},Q={class:"app-logo"},Y=["src"],Z={key:1,class:"default-logo rounded-circle"},$={class:"app-info"},ee={class:"app-title"},oe={class:"app-category"},te={style:{"background-color":"aliceblue"}},ne={style:{"background-color":"beige",float:"right"}},ae={class:"app-description"};function se(_,a,u,e,m,f){const p=A("RecursiveCategory");return c(),i(h,null,[n("div",F,[n("form",{class:"d-flex",role:"search",style:{width:"100%"},onSubmit:a[0]||(a[0]=(...t)=>e.handleSearch&&e.handleSearch(...t))},[n("input",q,null,512),a[3]||(a[3]=n("button",{class:"btn custom-search-btn",type:"submit"},[n("svg",{t:"1728041224119",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5573",width:"20",height:"20"},[n("path",{d:"M351.1808 59.2896A435.2 435.2 0 0 1 805.376 715.264 460.8 460.8 0 0 1 351.1808 59.3408z",fill:"#ffffff","p-id":"5574","data-spm-anchor-id":"a313x.search_index.0.i12.117c3a817iUd2m",class:"selected"}),n("path",{d:"M754.3808 722.2272a358.4 358.4 0 1 0-267.8272 120.2176 51.2 51.2 0 0 1 0 102.4 460.8 460.8 0 1 1 365.1584-179.712l118.8864 121.2416c23.7568 24.2176 23.552 63.0272-0.4096 87.04l-0.4096 0.4096a61.184 61.184 0 0 1-86.9888-0.4608l-148.0192-150.9376a61.7984 61.7984 0 0 1 0.4096-86.9888l0.4096-0.4096c5.632-5.5808 11.9808-9.8304 18.7904-12.8z m-467.968-364.5952h409.6a51.2 51.2 0 1 1 0 102.4h-409.6a51.2 51.2 0 1 1 0-102.4z m0 204.8h256a51.2 51.2 0 0 1 0 102.4h-256a51.2 51.2 0 1 1 0-102.4z",fill:"currentColor","p-id":"5575"})])],-1))],32),a[4]||(a[4]=n("br",null,null,-1))]),n("div",M,[n("span",{class:w(["capsule",{"capsule-active":!e.nowCategory&&e.nowHotOrAll==="ALL"}]),onClick:a[1]||(a[1]=t=>{e.nowCategory=null,e.nowHotOrAll="ALL",e.getAllApp()})}," 全部应用 ",2),n("span",{class:w(["capsule",{"capsule-active":!e.nowCategory&&e.nowHotOrAll==="HOT"}]),onClick:a[2]||(a[2]=t=>{e.nowCategory=null,e.nowHotOrAll="HOT",e.getHotApp()})}," 热门应用 ",2),(c(!0),i(h,null,x(e.topLevelCategories,t=>(c(),i("span",{key:t.id,class:w(["capsule",{"capsule-active":e.selectedCategory&&e.selectedCategory.parentId===t.id||e.nowCategory&&e.nowCategory.id===t.id}]),onClick:s=>{e.selectCategory(t)},title:t.description},g(t.name),11,V))),128))]),e.selectedCategory?(c(),i("div",j,[k(p,{category:e.selectedCategory,"now-category":e.nowCategory,onSelectCategory:e.selectCategory},null,8,["category","now-category","onSelectCategory"])])):K("",!0),n("div",W,[(c(!0),i(h,null,x(e.appList,t=>(c(),i("div",{class:"col-md-3 col-lg-3 col-sm-4 col-4 app-container",title:t.description},[n("a",{href:t.url,onClick:s=>{e.clickApp(t.id)},style:{"text-decoration":"none"}},[n("div",J,[n("div",Q,[t.iconUrl!==""?(c(),i("img",{key:0,src:t.iconUrl,alt:"App Logo",class:"img-fluid rounded-circle"},null,8,Y)):(c(),i("div",Z,g(t.name.charAt(0)),1))]),n("div",$,[n("div",ee,g(t.name),1),n("div",oe,[n("span",te,g(t.categoryName),1),a[5]||(a[5]=n("span",{style:{"background-color":"white"}},"   ",-1)),n("span",ne,g(t.clickCount),1)]),n("div",ae,g(t.description),1)])])],8,G)],8,X))),256))])],64)}const le=S(R,[["render",se],["__scopeId","data-v-47887973"]]),re={components:{HelloWorld:O,TopBar:E,ContentUserSection:le},data(){return{username:null}},created(){this.username=this.$route.params.username}},ce={class:"home-container"};function ie(_,a,u,e,m,f){const p=A("TopBar"),t=A("ContentUserSection");return c(),i(h,null,[k(p),n("div",ce,[k(t,{username:m.username},null,8,["username"])])],64)}const _e=S(re,[["render",ie],["__scopeId","data-v-c6f17a05"]]);export{_e as default};
