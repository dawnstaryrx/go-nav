import{_ as l,u as d,o as f,c as p,b as k,p as m,y as h,e as g}from"./index-DNkYr-Dp.js";import{u}from"./user-1tW7kAz0.js";import{u as _}from"./userInfo-C0I0oh51.js";const y={name:"OAuthCallback",setup(){const e=m(),r=h(),t=d(),a=async()=>(await u.getCurrentUser()).data;return f(async()=>{const n=new URLSearchParams(r.query).get("code");if(n)try{const s=await u.loginLinuxDo(n),o={token:"",refreshToken:""};if(o.token=s.data.token,o.refreshToken=s.data.refreshToken,console.log(o),o.token!=""){t.setToken(o);const i=await a();_().setInfo(i),e.push("/")}else console.error("No token received"),e.push({name:"login",query:{error:"认证失败，请重试。"}})}catch(s){console.error("Error during OAuth callback processing:",s),e.push({name:"login",query:{error:"认证过程中发生错误，请重试。"}})}else console.error("No code found in URL"),e.push({name:"login",query:{error:"缺少授权码，请重试。"}})}),{}}},w={class:"container"};function S(e,r,t,a,c,n){return g(),p("div",w,r[0]||(r[0]=[k("h1",null,"正在处理您的请求，请稍候。",-1)]))}const q=l(y,[["render",S],["__scopeId","data-v-1c2fd670"]]);export{q as default};
