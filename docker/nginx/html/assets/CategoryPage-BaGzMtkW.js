import{_ as U,r as v,o as I,c as n,b as t,k as d,C as f,w as y,F as L,h as O,v as c,n as k,M as V,q as u,e as i,t as r,x as z}from"./index-DNkYr-Dp.js";import{c as C}from"./category-D9zZmuIX.js";const h={setup(){const g=v({id:null,parentId:null,name:"",description:"",weight:1,status:1}),e=v([]),P=v([]);let o=null;const D=v(1),m=v({pageNum:1,pageSize:10}),a=l=>{const N=document.getElementById(l);o=new V(N),o.show()},T=l=>{l<1||l>D.value||(m.value.pageNum=l,b())},s=()=>{m.value.pageNum=1,b()},M=async()=>{try{(await C.addCategory(g.value)).code===0?(u.message("分类添加成功"),w(),o.hide(),b(),p()):u.message("添加分类失败，请重试","danger")}catch(l){console.error(l)}},x=async()=>{try{(await C.deleteCategory(g.value.id)).code===0?(u.message("分类删除成功"),w(),o.hide(),b(),p()):u.message("删除分类失败，请重试","danger")}catch(l){console.error(l)}},S=async()=>{try{(await C.updateCategory(g.value)).code===0?(u.message("分类修改成功"),w(),o.hide(),b(),p()):u.message("修改分类失败，请重试","danger")}catch(l){console.error(l)}},b=async()=>{try{const l=await C.getCategoryPageList(m.value.pageNum,m.value.pageSize);console.log(l),e.value=l.data.items,console.log(e.value),D.value=parseInt(l.data.total/m.value.pageSize)+1}catch(l){console.error(l)}};b();const p=async()=>{try{const l=await C.getCategoryList();console.log(l),P.value=l.data}catch(l){console.error(l)}},w=()=>{g.value={id:null,parentId:null,name:"",description:"",weight:1,status:1}};return I(()=>{p()}),{categoryDTO:g,openModal:a,submitCategory:M,resetForm:w,getCategoryPageList:b,categoryList:e,submitUpdateCategory:S,submitDeleteCategory:x,getCategoryPageListData:m,changePage:T,totalPages:D,changePageSize:s,getCategoryList:p,categoryNowList:P}}},B={class:"container mt-4",style:{margin:"0px"}},E={class:"row"},F={class:"col"},j={class:"mb-3 d-flex justify-content-end col"},q={class:"modal fade",id:"addCategoryModal",tabindex:"-1","aria-labelledby":"addCategoryModalLabel","aria-hidden":"true"},A={class:"modal-dialog"},G={class:"modal-content"},H={class:"modal-body"},J={class:"mb-3"},K=["value"],Q={class:"mb-3"},R={class:"mb-3"},W={class:"mb-3"},X={class:"mb-3"},Y={class:"table table-striped table-hover text-center"},Z={scope:"row"},_={key:0,class:"badge bg-success"},$={key:1,class:"badge bg-danger"},tt=["onClick"],et={class:"modal-dialog"},ot={class:"modal-content"},at={class:"modal-header"},lt={class:"modal-body"},st={class:"mb-3"},nt=["value"],dt={class:"mb-3"},it={class:"mb-3"},rt={class:"mb-3"},gt={class:"mb-3"},mt=["onClick"],bt={class:"modal-dialog"},yt={class:"modal-content"},ct={class:"modal-body"},ut={"aria-label":"Page navigation"},pt={class:"pagination justify-content-center"},vt=["onClick"];function ft(g,e,P,o,D,m){return i(),n("div",B,[t("div",E,[t("div",F,[t("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=a=>o.openModal("addCategoryModal"))},"添加分类")]),t("div",j,[e[22]||(e[22]=t("label",{for:"pageSizeSelect",class:"me-2",style:{"line-height":"38px"}},"每页显示:",-1)),d(t("select",{id:"pageSizeSelect",class:"form-select w-auto","onUpdate:modelValue":e[1]||(e[1]=a=>o.getCategoryPageListData.pageSize=a),onChange:e[2]||(e[2]=(...a)=>o.changePageSize&&o.changePageSize(...a))},e[21]||(e[21]=[t("option",{value:"10"},"10",-1),t("option",{value:"20"},"20",-1),t("option",{value:"30"},"30",-1),t("option",{value:"50"},"50",-1)]),544),[[f,o.getCategoryPageListData.pageSize]])])]),t("div",q,[t("div",A,[t("div",G,[e[31]||(e[31]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"addCategoryModalLabel"},"添加分类"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",H,[t("form",{onSubmit:e[8]||(e[8]=y((...a)=>o.submitCategory&&o.submitCategory(...a),["prevent"]))},[t("div",J,[e[24]||(e[24]=t("label",{for:"parentId",class:"form-label"},"父分类",-1)),d(t("select",{"onUpdate:modelValue":e[3]||(e[3]=a=>o.categoryDTO.parentId=a),class:"form-select",id:"parentId"},[e[23]||(e[23]=t("option",{value:"",disabled:""},"请选择父分类",-1)),(i(!0),n(L,null,O(o.categoryNowList,a=>(i(),n("option",{key:a.id,value:a.id},r(a.name),9,K))),128))],512),[[f,o.categoryDTO.parentId]])]),t("div",Q,[e[25]||(e[25]=t("label",{for:"name",class:"form-label"},"分类名称",-1)),d(t("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>o.categoryDTO.name=a),type:"text",class:"form-control",id:"name",placeholder:"输入分类名称"},null,512),[[c,o.categoryDTO.name]])]),t("div",R,[e[26]||(e[26]=t("label",{for:"description",class:"form-label"},"描述",-1)),d(t("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>o.categoryDTO.description=a),type:"text",class:"form-control",id:"description",placeholder:"输入分类描述"},null,512),[[c,o.categoryDTO.description]])]),t("div",W,[e[27]||(e[27]=t("label",{for:"weight",class:"form-label"},"权重",-1)),d(t("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>o.categoryDTO.weight=a),type:"number",class:"form-control",id:"weight",placeholder:"输入权重"},null,512),[[c,o.categoryDTO.weight]])]),t("div",X,[e[29]||(e[29]=t("label",{for:"status",class:"form-label"},"状态",-1)),d(t("select",{"onUpdate:modelValue":e[7]||(e[7]=a=>o.categoryDTO.status=a),class:"form-select",id:"status"},e[28]||(e[28]=[t("option",{value:"1"},"启用",-1),t("option",{value:"0"},"禁用",-1)]),512),[[f,o.categoryDTO.status]])]),e[30]||(e[30]=t("button",{type:"submit",class:"btn btn-primary"},"确认添加",-1))],32)])])])]),t("div",null,[t("table",Y,[e[43]||(e[43]=t("thead",null,[t("tr",null,[t("th",{scope:"col"},"#"),t("th",{scope:"col"},"id"),t("th",{scope:"col"},"名称"),t("th",{scope:"col"},"父分类"),t("th",{scope:"col"},"权重"),t("th",{scope:"col"},"状态"),t("th",{scope:"col"},"操作")])],-1)),t("tbody",null,[(i(!0),n(L,null,O(o.categoryList,(a,T)=>(i(),n("tr",null,[t("th",Z,r(T+1),1),t("td",null,r(a.id),1),t("td",null,r(a.name),1),t("td",null,r(a.parentName),1),t("td",null,r(a.weight),1),t("td",null,[a.status===1?(i(),n("span",_,"启用")):(i(),n("span",$,"禁用"))]),t("td",null,[t("button",{class:"btn btn-primary btn-sm",onClick:s=>{o.categoryDTO=a,o.openModal("updateCategoryModal")}},"编辑",8,tt),t("div",{class:"modal fade text-start",id:"updateCategoryModal",tabindex:"-1","aria-labelledby":"updateCategoryModalLabel","aria-hidden":"true",onClick:e[16]||(e[16]=s=>o.getCategoryPageList())},[t("div",et,[t("div",ot,[t("div",at,[e[32]||(e[32]=t("h5",{class:"modal-title",id:"addCategoryModalLabel"},"编辑分类",-1)),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:e[9]||(e[9]=s=>o.categoryDTO=g.origincategoryDTO)})]),t("div",lt,[t("form",{onSubmit:e[15]||(e[15]=y((...s)=>o.submitUpdateCategory&&o.submitUpdateCategory(...s),["prevent"]))},[t("div",st,[e[34]||(e[34]=t("label",{for:"parentId",class:"form-label"},"父分类",-1)),d(t("select",{"onUpdate:modelValue":e[10]||(e[10]=s=>o.categoryDTO.parentId=s),class:"form-select",id:"parentId"},[e[33]||(e[33]=t("option",{value:"",disabled:""},"请选择父分类",-1)),(i(!0),n(L,null,O(o.categoryNowList,s=>(i(),n("option",{key:s.id,value:s.id},r(s.name),9,nt))),128))],512),[[f,o.categoryDTO.parentId]])]),t("div",dt,[e[35]||(e[35]=t("label",{for:"name",class:"form-label"},"分类名称",-1)),d(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>o.categoryDTO.name=s),type:"text",class:"form-control",id:"name",placeholder:"输入分类名称"},null,512),[[c,o.categoryDTO.name]])]),t("div",it,[e[36]||(e[36]=t("label",{for:"description",class:"form-label"},"描述",-1)),d(t("input",{"onUpdate:modelValue":e[12]||(e[12]=s=>o.categoryDTO.description=s),type:"text",class:"form-control",id:"description",placeholder:"输入分类描述"},null,512),[[c,o.categoryDTO.description]])]),t("div",rt,[e[37]||(e[37]=t("label",{for:"weight",class:"form-label"},"权重",-1)),d(t("input",{"onUpdate:modelValue":e[13]||(e[13]=s=>o.categoryDTO.weight=s),type:"number",class:"form-control",id:"weight",placeholder:"输入权重"},null,512),[[c,o.categoryDTO.weight]])]),t("div",gt,[e[39]||(e[39]=t("label",{for:"status",class:"form-label"},"状态",-1)),d(t("select",{"onUpdate:modelValue":e[14]||(e[14]=s=>o.categoryDTO.status=s),class:"form-select",id:"status"},e[38]||(e[38]=[t("option",{value:"1"},"启用",-1),t("option",{value:"0"},"禁用",-1)]),512),[[f,o.categoryDTO.status]])]),e[40]||(e[40]=t("button",{type:"submit",class:"btn btn-primary"},"确认修改",-1))],32)])])])]),t("button",{class:"btn btn-danger btn-sm",onClick:s=>{o.categoryDTO=a,o.openModal("deleteCategoryModal")},style:{"margin-left":"5px"}},"删除",8,mt),t("div",{class:"modal fade text-start",id:"deleteCategoryModal",tabindex:"-1","aria-labelledby":"deleteCategoryModalLabel","aria-hidden":"true",onClick:e[18]||(e[18]=s=>o.getCategoryPageList())},[t("div",bt,[t("div",yt,[e[42]||(e[42]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"addCategoryModalLabel"},"删除分类"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",ct,[z(" 确定删除分类 "+r(o.categoryDTO.name)+"？ ",1),t("form",{onSubmit:e[17]||(e[17]=y((...s)=>o.submitDeleteCategory&&o.submitDeleteCategory(...s),["prevent"]))},e[41]||(e[41]=[t("button",{type:"submit",class:"btn btn-primary",style:{float:"inline-end"}},"确认删除",-1)]),32)])])])])])]))),256))])]),t("nav",ut,[t("ul",pt,[t("li",{class:k(["page-item",{disabled:o.getCategoryPageListData.pageNum===1}])},[t("a",{class:"page-link",href:"#",onClick:e[19]||(e[19]=y(a=>o.changePage(o.getCategoryPageListData.pageNum-1),["prevent"]))},"上一页")],2),(i(!0),n(L,null,O(o.totalPages,a=>(i(),n("li",{class:k(["page-item",{active:a===o.getCategoryPageListData.pageNum}]),key:a},[t("a",{class:"page-link",href:"#",onClick:y(T=>o.changePage(a),["prevent"])},r(a),9,vt)],2))),128)),t("li",{class:k(["page-item",{disabled:o.getCategoryPageListData.pageNum===o.totalPages}])},[t("a",{class:"page-link",href:"#",onClick:e[20]||(e[20]=y(a=>o.changePage(o.getCategoryPageListData.pageNum+1),["prevent"]))},"下一页")],2)])])])])}const Tt=U(h,[["render",ft],["__scopeId","data-v-05205cf7"]]);export{Tt as default};
