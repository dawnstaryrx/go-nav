import{_ as w,r as y,c as r,b as e,k as N,C as z,F as k,h,n as b,w as v,M as x,q as C,e as i,t as n,x as B}from"./index-DNkYr-Dp.js";import{c as f}from"./category-D9zZmuIX.js";const M={setup(){const g=y({id:null,parentId:null,name:"",description:"",weight:1,status:1}),t=y([]);let c=null;const a=y(1),l=y({pageNum:1,pageSize:10,orderBy:null,searchContent:null}),P=s=>{const S=document.getElementById(s);c=new x(S),c.show()},o=s=>{s<1||s>a.value||(l.value.pageNum=s,d())},m=()=>{l.value.pageNum=1,d()},u=s=>{l.value.orderBy===`${s} asc`?l.value.orderBy=`${s} desc`:l.value.orderBy=`${s} asc`,console.log(l.orderBy),d()},D=async()=>{try{(await f.addCategory(g.value)).code===0?(C.message("分类添加成功"),p(),c.hide()):C.message("添加分类失败，请重试","danger")}catch(s){console.error(s)}},L=async()=>{try{(await f.deleteCategoryAdmin(g.value.id)).code===0?(C.message("分类删除成功"),p(),c.hide(),d()):C.message("删除分类失败，请重试","danger")}catch(s){console.error(s)}},d=async()=>{try{const s=await f.getAllCategory(l.value.pageNum,l.value.pageSize,l.value.searchContent,l.value.orderBy);console.log(s),t.value=s.data.items,console.log(t.value),a.value=parseInt(s.data.total/l.value.pageSize)+1}catch(s){console.error(s)}};d();const p=()=>{g.value={id:null,parentId:null,name:"",description:"",weight:1,status:1}};return{categoryDTO:g,openModal:P,submitCategory:D,resetForm:p,getCategoryPageList:d,categoryList:t,submitDeleteCategory:L,getCategoryPageListData:l,changePage:o,totalPages:a,changePageSize:m,sortColumn:u}}},I={class:"container mt-4",style:{margin:"0px"}},A={class:"mb-3 d-flex justify-content-start col"},E={class:"table"},F={scope:"row"},T={key:0,class:"badge bg-success"},U={key:1,class:"badge bg-danger"},V=["onClick"],_=["id"],j={class:"modal-dialog"},O={class:"modal-content"},q={class:"modal-body"},G={"aria-label":"Page navigation"},H={class:"pagination justify-content-center"},J=["onClick"];function K(g,t,c,a,l,P){return i(),r("div",I,[e("div",A,[t[12]||(t[12]=e("label",{for:"pageSizeSelect",class:"me-2",style:{"line-height":"38px"}},"每页显示:",-1)),N(e("select",{id:"pageSizeSelect",class:"form-select w-auto","onUpdate:modelValue":t[0]||(t[0]=o=>a.getCategoryPageListData.pageSize=o),onChange:t[1]||(t[1]=(...o)=>a.changePageSize&&a.changePageSize(...o))},t[11]||(t[11]=[e("option",{value:"10"},"10",-1),e("option",{value:"20"},"20",-1),e("option",{value:"30"},"30",-1),e("option",{value:"50"},"50",-1)]),544),[[z,a.getCategoryPageListData.pageSize]])]),e("div",null,[e("table",E,[e("thead",null,[e("tr",null,[t[13]||(t[13]=e("th",{scope:"col"},"#",-1)),e("th",{scope:"col",onClick:t[2]||(t[2]=o=>a.sortColumn("c.id")),style:{cursor:"pointer"}},"id"),e("th",{scope:"col",onClick:t[3]||(t[3]=o=>a.sortColumn("c.name")),style:{cursor:"pointer"}},"名称"),e("th",{scope:"col",onClick:t[4]||(t[4]=o=>a.sortColumn("parentName")),style:{cursor:"pointer"}},"父分类"),e("th",{scope:"col",onClick:t[5]||(t[5]=o=>a.sortColumn("c.weight")),style:{cursor:"pointer"}},"权重"),e("th",{scope:"col",onClick:t[6]||(t[6]=o=>a.sortColumn("c.status")),style:{cursor:"pointer"}},"状态"),t[14]||(t[14]=e("th",{scope:"col"},"所属用户Id",-1)),t[15]||(t[15]=e("th",{scope:"col"},"操作",-1))])]),e("tbody",null,[(i(!0),r(k,null,h(a.categoryList,(o,m)=>(i(),r("tr",null,[e("th",F,n(m+1),1),e("td",null,n(o.id),1),e("td",null,n(o.name),1),e("td",null,n(o.parentName),1),e("td",null,n(o.weight),1),e("td",null,[o.status===1?(i(),r("span",T,"启用")):(i(),r("span",U,"禁用"))]),e("td",null,n(o.createUser),1),e("td",null,[e("button",{class:"btn btn-danger btn-sm",onClick:u=>{a.categoryDTO=o,a.openModal("deleteCategoryModal"+o.id)}},"删除",8,V),e("div",{class:"modal fade text-start",id:"deleteCategoryModal"+o.id,tabindex:"-1","aria-labelledby":"deleteCategoryModalLabel","aria-hidden":"true",onClick:t[8]||(t[8]=u=>a.getCategoryPageList())},[e("div",j,[e("div",O,[t[17]||(t[17]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"addCategoryModalLabel"},"删除分类"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",q,[B(" 确定删除分类 "+n(o.name)+" ？ ",1),e("form",{onSubmit:t[7]||(t[7]=v((...u)=>a.submitDeleteCategory&&a.submitDeleteCategory(...u),["prevent"]))},t[16]||(t[16]=[e("button",{type:"submit",class:"btn btn-primary",style:{float:"inline-end"}},"确认删除",-1)]),32)])])])],8,_)])]))),256))])]),e("nav",G,[e("ul",H,[e("li",{class:b(["page-item",{disabled:a.getCategoryPageListData.pageNum===1}])},[e("a",{class:"page-link",href:"#",onClick:t[9]||(t[9]=v(o=>a.changePage(a.getCategoryPageListData.pageNum-1),["prevent"]))},"上一页")],2),(i(!0),r(k,null,h(a.totalPages,o=>(i(),r("li",{class:b(["page-item",{active:o===a.getCategoryPageListData.pageNum}]),key:o},[e("a",{class:"page-link",href:"#",onClick:v(m=>a.changePage(o),["prevent"])},n(o),9,J)],2))),128)),e("li",{class:b(["page-item",{disabled:a.getCategoryPageListData.pageNum===a.totalPages}])},[e("a",{class:"page-link",href:"#",onClick:t[10]||(t[10]=v(o=>a.changePage(a.getCategoryPageListData.pageNum+1),["prevent"]))},"下一页")],2)])])])])}const W=w(M,[["render",K],["__scopeId","data-v-8282a1c6"]]);export{W as default};
