import{_ as N,r as p,o as h,c as r,b as e,k,C as f,F as v,h as P,n as b,w as m,q as D,e as i,t as n,j as z}from"./index-DNkYr-Dp.js";import{u as L}from"./user-1tW7kAz0.js";const O={name:"UserAdminPage",setup(){const g=p(1),o=p([]),s=p({pageNum:1,pageSize:10,searchContent:"",orderBy:"id desc"}),l=p({role:0,userId:null}),y=async(a,S)=>{const C=await L.updateUserRole(a,S);C.code===0?(D.message("修改成功"),d()):D.message("修改失败","danger"),console.log(C)},d=async()=>{const a=await L.getUserPageList(s.value.pageNum,s.value.pageSize,s.value.searchContent,s.value.orderBy);console.log(a),o.value=a.data.items,g.value=parseInt(a.data.total/s.value.pageSize)},t=a=>{s.value.orderBy===`${a} asc`?s.value.orderBy=`${a} desc`:s.value.orderBy=`${a} asc`,console.log(s.orderBy),d()},c=a=>{a<1||a>g.value||(s.value.pageNum=a,d())},u=()=>{s.value.pageNum=1,d()};return h(()=>{d()}),{userPageList:o,userPageListDTO:s,getUserPageList:d,sortColumn:t,changePage:c,changePageSize:u,totalPages:g,updateUserRole:y,updateRoleData:l}}},R={class:"mb-3 d-flex justify-content-start col"},U={class:"table text-center"},w={scope:"row"},x={key:0,style:{"background-color":"grey",color:"white"}},B={key:1},T={key:2,style:{"background-color":"antiquewhite"}},M=["href"],A=["onClick","data-bs-target"],I=["id"],V={class:"modal-dialog"},j={class:"modal-content"},_={class:"modal-body"},q={class:"mb-3"},F=["value"],E={class:"mb-3"},G={"aria-label":"Page navigation"},H={class:"pagination justify-content-center"},J=["onClick"];function K(g,o,s,l,y,d){return i(),r(v,null,[e("div",R,[o[16]||(o[16]=e("label",{for:"pageSizeSelect",class:"me-2",style:{"line-height":"38px"}},"每页显示:",-1)),k(e("select",{id:"pageSizeSelect",class:"form-select w-auto","onUpdate:modelValue":o[0]||(o[0]=t=>l.userPageListDTO.pageSize=t),onChange:o[1]||(o[1]=(...t)=>l.changePageSize&&l.changePageSize(...t))},o[15]||(o[15]=[e("option",{value:"10"},"10",-1),e("option",{value:"20"},"20",-1),e("option",{value:"30"},"30",-1),e("option",{value:"50"},"50",-1)]),544),[[f,l.userPageListDTO.pageSize]])]),e("div",null,[e("table",U,[e("thead",null,[e("tr",null,[o[17]||(o[17]=e("th",{scope:"col"},"#",-1)),e("th",{scope:"col",onClick:o[2]||(o[2]=t=>l.sortColumn("id")),style:{cursor:"pointer"}},"id"),e("th",{scope:"col",onClick:o[3]||(o[3]=t=>l.sortColumn("username")),style:{cursor:"pointer"}},"用户名"),e("th",{scope:"col",onClick:o[4]||(o[4]=t=>l.sortColumn("email")),style:{cursor:"pointer"}},"邮箱"),e("th",{scope:"col",onClick:o[5]||(o[5]=t=>l.sortColumn("github_openid")),style:{cursor:"pointer"}},"GitHub"),e("th",{scope:"col",onClick:o[6]||(o[6]=t=>l.sortColumn("linuxdo_openid")),style:{cursor:"pointer"}},"LinuxDo"),e("th",{scope:"col",onClick:o[7]||(o[7]=t=>l.sortColumn("create_time")),style:{cursor:"pointer"}},"注册时间"),e("th",{scope:"col",onClick:o[8]||(o[8]=t=>l.sortColumn("app_num")),style:{cursor:"pointer"}},"APP数"),e("th",{scope:"col",onClick:o[9]||(o[9]=t=>l.sortColumn("category_num")),style:{cursor:"pointer"}},"分类数"),o[18]||(o[18]=e("th",{scope:"col"},"操作",-1))])]),e("tbody",null,[(i(!0),r(v,null,P(l.userPageList,(t,c)=>(i(),r("tr",{key:c},[e("th",w,n(c+1),1),e("td",null,[t.role===0?(i(),r("span",x,n(t.id),1)):t.role===1?(i(),r("span",B,n(t.id),1)):t.role===2?(i(),r("span",T,n(t.id),1)):z("",!0)]),e("td",null,[e("a",{href:"/nav/"+t.username,target:"_blank"},n(t.username),9,M)]),e("td",null,n(t.email),1),e("td",null,n(t.githubOpenid),1),e("td",null,n(t.linuxdoOpenid),1),e("td",null,n(t.createTime),1),e("td",null,n(t.appNum),1),e("td",null,n(t.categoryNum),1),e("td",null,[e("button",{type:"button",class:"btn btn-primary btn-sm",onClick:u=>{l.updateRoleData.role=t.role,l.updateRoleData.userId=t.id},"data-bs-toggle":"modal","data-bs-target":"#updateModal"+t.id}," 修改 ",8,A),e("div",{class:"modal fade text-start",id:"updateModal"+t.id,tabindex:"-1","aria-labelledby":"updateModalLabel","aria-hidden":"true"},[e("div",V,[e("div",j,[o[22]||(o[22]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"addCategoryModalLabel"},"修改用户状态"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",_,[e("form",{onSubmit:o[12]||(o[12]=m((...u)=>g.submitDeleteCategory&&g.submitDeleteCategory(...u),["prevent"]))},[e("div",q,[o[19]||(o[19]=e("label",{for:"username",class:"form-label"},"用户名",-1)),e("input",{value:t.username,type:"text",class:"form-control",id:"username",disabled:""},null,8,F)]),e("div",E,[o[21]||(o[21]=e("label",{for:"role",class:"form-label"},"角色",-1)),k(e("select",{"onUpdate:modelValue":o[10]||(o[10]=u=>l.updateRoleData.role=u),class:"form-select",id:"role"},o[20]||(o[20]=[e("option",{value:"1"},"用户",-1),e("option",{value:"2"},"管理员",-1)]),512),[[f,l.updateRoleData.role]])]),e("button",{onClick:o[11]||(o[11]=u=>l.updateUserRole(l.updateRoleData.role,l.updateRoleData.userId)),class:"btn btn-primary"},"确认修改")],32)])])])],8,I)])]))),128))])]),e("nav",G,[e("ul",H,[e("li",{class:b(["page-item",{disabled:l.userPageListDTO.pageNum===1}])},[e("a",{class:"page-link",href:"#",onClick:o[13]||(o[13]=m(t=>l.changePage(l.userPageListDTO.pageNum-1),["prevent"]))},"上一页")],2),(i(!0),r(v,null,P(l.totalPages,t=>(i(),r("li",{class:b(["page-item",{active:t===l.userPageListDTO.pageNum}]),key:t},[e("a",{class:"page-link",href:"#",onClick:m(c=>l.changePage(t),["prevent"])},n(t),9,J)],2))),128)),e("li",{class:b(["page-item",{disabled:l.userPageListDTO.pageNum===l.totalPages}])},[e("a",{class:"page-link",href:"#",onClick:o[14]||(o[14]=m(t=>l.changePage(l.userPageListDTO.pageNum+1),["prevent"]))},"下一页")],2)])])])],64)}const X=N(O,[["render",K]]);export{X as default};
